<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../../css/master.css">
    <style media="screen">
      ul {
        line-height: 1.5;
      }
      .collapsible {
      background-color: #eeeeee;
      color: black;
      cursor: pointer;
      padding: 18px;
      width: 100%;
      border: none;
      text-align: left;
      outline: none;
      font-size: 15px;
      margin-bottom: 10px;
      }
      .active, .collapsible:hover {
      background-color: #888;
      }
      .content {
      padding: 0 18px;
      display: none;
      overflow: hidden;
      background-color: #fff;
      border: 1px solid black;
      margin-bottom: 10px;
      }
    </style>
    <title>genCorrelationMatrix</title>
  </head>
  <body>
    <h2>genCorrelationMatrix</h2>
    <hr>
    <p>
      Generate correlation matrix from image time series.
    </p>
    <h3 id="description">Description</h3>
    <hr>
    <p>
      This function creates a Pearson's correlation matrix from ROIs of image time series data. Here, one can create the correlation matrix using either the centroid pixels and/or all the pixels from the ROIs (see <a href="#parameters">parameters</a> for details).
    </p>
    <h3>Input</h3>
    <hr>
    <p>
      This function accepts only image time series with dimensions Y, X and T as input.
    </p>
    <h3>Output</h3>
    <hr>
    <p>
      The output of this function is a <samp>.mat</samp> file containing the correlation matrix with dimensions N x N where N is the number of ROIs.
      <div class="infonote">
        <p><strong>Note</strong><br>
          The output of this function is used in the <i>Analysis</i> tab of the <samp>umIToolbox</samp>app to visualize and compare grouped datasets.
        </p>
      </div>
    </p>
    <h3 id="parameters">Parameters</h3>
    <hr>
    <button title="click to expand" type="button" class="collapsible">
      <span class="iconplus"></span>
      <samp><b>ROImasks_filename</b></samp> - name of ROImasks file<br>
      <span class="title-desc"><i> 'ROImasks_data.mat' (default) | string </i></span>
    </button>
    <div class="content">
      <p>
        This parameter contains the name of the <samp>.mat</samp> file starting with <small>ROImasks_</small> generated by the <samp>ROImanager</samp> app. This file contains the ROIs logical masks that will be used by this function to extract the ROI data.
      </p>
    </div>
    <button title="click to expand" type="button" class="collapsible">
      <span class="iconplus"></span>
      <samp><b>CorrAlgorithm</b></samp> - Correlation algorithm<br>
      <span class="title-desc"><i> centroid_vs_centroid (default) | centroid_vs_agg | avg_vs_avg </i></span>
    </button>
    <div class="content">
      <p>
        This parameter sets the correlation algorithm to be used by the function. There are three options:
      </p>
      <ul>
        <li><i>centroid_vs_centroid</i>: calculates the Pearson's correlation between the centroid pixels of all ROIs</li>
        <li><i>centroid_vs_agg</i>: calculates the Pearson's correlation between the centroid pixel of the <i>source</i> ROI and the aggregated value (calculated using the function set in the <samp>SpatialAggFcn</samp> parameter) of the target ROI</li>
        <li><i>avg_vs_avg</i>: calculates the Pearson's correlation between the spatial pixel average of both the <i>source</i> and the <i>target</i> ROIs</li>
      </ul>
    </div>
    <button title="click to expand" type="button" class="collapsible">
      <span class="iconplus"></span>
      <samp><b>SpatialAggFcn</b></samp> - Spatial aggregation function<br>
      <span class="title-desc"><i> mean (default) | max | min | median </i></span>
    </button>
    <div class="content">
      <p>
        This parameter states the function that will be used to aggregate the ROI data. The selected function will be applied to all pixels inside the ROI.
      </p>
      <div class="infonote">
        <p><strong>Note</strong><br>
          This parameter is used <b>only</b> when the parameter <samp>CorrAlgorithm</samp> is set to <i>centroid_vs_agg</i>. Otherwise, it will be ignored.
        </p>
      </div>
    </div>
    <button title="click to expand" type="button" class="collapsible">
      <span class="iconplus"></span>
      <samp><b>b_FisherZ_transform</b></samp> - Apply Fisher Z transform<br>
      <span class="title-desc"><i> true | false (default) </i></span>
    </button>
    <div class="content">
      <p>
        Set this parameter to <b>True</b> to apply a Fisher Z transformation of the Pearson's correlation values.
      </p>
    </div>
    <button title="click to expand" type="button" class="collapsible">
      <span class="iconplus"></span>
      <samp><b>b_genSPCMaps</b></samp> - Create SCPMaps<br>
      <span class="title-desc"><i> true | false (default) </i></span>
    </button>
    <div class="content">
      <p>
        Set this parameter to <b>True</b> to create a file containing the Seed Pixel Correlation Maps for each ROI. The maps are created using the centroid pixel of the <i>source</i> ROI as seed. The maps are stored in a file named <samp>SPCMaps.mat</samp> and it can be accessed through the <i>Analysis</i> tab of <a href="umIToolbox-Analysis.html">umIToolbox</a> app.
      </p>
      <div class="infonote">
        <p><strong>Note</strong><br>
          This parameter is taken into account <b>only</b> when the correlation algorithm is set to <samp>centroid_vs_centroid</samp> or <samp>centroid_vs_agg</samp>. Thus, the SPCMaps are not create when the algorithm <samp>avg_vs_avg</samp> is used.
        </p>
      </div>
    </div>

    <!-- JavaScript code to collapse sections -->
    <script src="collapsible_behaviour.js"></script>
  </body>
</html>
