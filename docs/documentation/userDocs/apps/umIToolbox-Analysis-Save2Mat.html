---
permalink: /documentation/userDocs/apps/umIToolbox-Analysis-Save2Mat.html
layout: default
---
<html lang="en">
<head>
    <!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>    
    <meta charset="utf-8">
    <style media="screen">
      ul,ol {
        line-height: 1.5;
      }
    </style>
    <title>Saving to .MAT</title>      
</head>
<body>
    <h2>Saving data to <samp>.MAT</samp></h2>
    <hr>
    <p>
        The <b><i>umIToolbox</i></b> offers the possibility to extract the data from several recordings and save to a <samp>.mat</samp> file to be used outside the toolbox.        
    </p>
    <p>
        This section describes how the data is structured and gives an example on how to work with the extracted data.
    </p>
    <div class="warnnote">
        <p><strong>Important</strong><br>
            We assume that the data was already preprocessed and saved in <samp>.mat</samp> files and selected in the <samp>umIToolbox</samp> <i>Analysis</i> tab. To learn how to select the data, click <a href="./umIToolbox-Analysis.html">here</a>.            
        </p>
    </div>
    <h3 id="the-data-structure">The data structure</h3>
    <hr>
    <p>
        The <samp>.mat</samp> file is generated using the <samp>Save2Mat</samp> tool in the <a href="./umIToolbox-Analysis.html">Analysis tab</a> from the <b><i>umIToolbox</i></b> app. The file contains the lists of groups (<samp>list_of_grous</samp>), events (<samp>list_of_events</samp>) and observations (<samp>list_of_observations</samp>) stored as cell arrays of characters. In addition the data and metadata of each recording are stored in a variable named <samp>stats_data</samp>.
    </p>
    <p>
        The <samp>stats_data</samp> consists of a structure array in which each item corresponds to an acquisition (i.e. recording) selected in the <i>object Tree</i> from umIT's <a href="./umIToolbox-Analysis.html"></a><i>Analysis tab</i>. 
    </p>
    <p>
        Each element of the structure array contains the following fields:        
    </p>
    <table style="table-layout: fixed;">
        <tr>
          <th style="width:130px" align="left">Field</th>
          <th align="left">Description</th>
        </tr>
        <tr>
          <td class="add_font_monospace">groupID</td>
          <td>The name of the experimental group</td>
        </tr>
        <tr>
          <td class="add_font_monospace">SubjectID</td>
          <td>The name of the subject</td>
        </tr>
        <tr>
            <td class="add_font_monospace">AcquisitionID</td>
            <td>The name of the acquisition/recording</td>
        </tr>
        <tr>
            <td class="add_font_monospace">ModalityID</td>
            <td>The name of the recording modality</td>
        </tr>
        <tr>
            <td class="add_font_monospace">RecStartDateTime</td>
            <td>Timestamp of the recording (start) with format <samp>YYYY-MM-DD HH:mm:ss</samp></td>
        </tr>
        <tr>
            <td class="add_font_monospace">dataFile</td>
            <td>Full path to the <samp>.mat</samp>file containing the recording's data</td>
        </tr>
        <tr>
            <td class="add_font_monospace">labels</td>
            <td>Cell array containing labels for each data point. The labels are generated by one of the <a href="../fcns.html">Analysis functions</a></td>            
        </tr>
        <tr>
            <td class="add_font_monospace">observationID</td>
            <td>Cell array with the names of each observation (e.g. ROIs)</td>
        </tr>
        <tr>
            <td class="add_font_monospace">data</td>
            <td>Cell array with the data of each observation (in the same order as <samp>observationID</samp>)</td>
        </tr>
        <tr>
            <td class="add_font_monospace">dataSize</td>
            <td>Cell array the size of each element of <samp>data</samp></td>
        </tr>
        <tr>
            <td class="add_font_monospace">AcquisitionIndx</td>
            <td>Index of acquisition. For instance, an <samp>AcquisitionIndx</samp> of <b>3</b> means that this is the third recording of a given Subject</td>
        </tr>
        <tr>
            <td class="add_font_monospace">b_isBaseline</td>
            <td>Boolean indicating if this recording is considered as <b>baseline</b></td>
        </tr>
        <tr>
            <td class="add_font_monospace">b_hasEvents</td>
            <td>Boolean indicating if the data contains <b>events</b></td>
        </tr>
        <tr>
            <td class="add_font_monospace">gIndx</td>
            <td>Group index from the <samp>list_of_groups</samp> list.</td>
        </tr>
        <tr>
            <td class="add_font_monospace">sIndx</td>
            <td>Subject index. For instance, an <samp>sIndx</samp> of <b>2</b> means that the <samp>SubjectID</samp> is the second subject in the list of subjects (list not saved)</td>
        </tr>
        <tr>
            <td class="add_font_monospace">rIndx</td>
            <td>Array of observation indices. The list of indices associated with each observation listed in the <samp>observationID</samp> field. Each index points to the position of an element in the <samp>list_of_observations</samp> list</td>
        </tr>
        <tr>
            <td class="add_font_monospace">eIndx</td>
            <td>Array of event indices. The list of indices associated with each event listed in the <samp>list_of_events</samp> list. If the data has no events, the index is equal to <b>zero</b></td></td>
        </tr>
      </table>
      <h3 id="example">Example code</h3>
      <hr>
      <p>
        Here is an example on how to use the data extracted from <b><i>umIT</i></b>:
      </p>
      <div class="black-box">        
        <pre>            
            <code id="code-content" class="code-block">                 
% In this example, the data consists of scalar values (single values)
% corresponding to the response amplitude of the primary motor cortex 
% following a sensory stimulation.
% The data consists of a single group containing four subjects and
% four acquisition per subject.
%% Load the extracted data:
s = load('test_dataStruct.mat');
%% Get the data of each group
% Here, we will create column vectors of the acquisition indices and data
% values for the observation "M1_R"

% Preallocate variables
x = zeros(length(s.stats_data),1, 'single'); 
y = x;
% Populate x and y variables with the acquisition index and data values
% respectively:
for ind = 1:length(s.stats_data)
    x(ind) =  s.stats_data(ind).AcquisitionIndx;
    % Find observation "M1_R";
    iObs = strcmpi('M1_R', s.stats_data(ind).observationID);
    % Get data from the selected observation:
    y(ind) = s.stats_data(ind).data{iObs};
end
%% Plot data:
% Now, we will use the toolbox's plotting function "stripchart" to plot 
% boxplots of the responses across acquisitions:
ax = stripchart(x,y,'Boxplot', true);
% Customize axis:
ax.Title.String = 'M1 response across time';
ax.XLabel.String = 'Acquisition index';
ax.YLabel.String = 'Response amplitude';
            </code>            
        </pre>
      </div>
      <br>
      <p>Here is the resulting plot:</p>
    <p style="text-align:center">
        <img src="../../assets/img/save2mat_examplePlot.png" alt="example_plot" width="440">
    </p>    
    <hr>
</body>
</html>