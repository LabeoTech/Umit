<html lang="en">

<head>
    <link rel="stylesheet" href="../../css/master.css">
    <style media="screen">
        ul {
            line-height: 1.5;
        }
    </style>
    <meta charset="utf-8">
    <title>How umIT performs hypothesis tests</title>
</head>

<body>
    <h2>How <b><i>umIT</i></b> performs hypothesis tests</h2>
    <hr>
    <h3>First, a word of caution</h3>
    <p>
        The <b><i>umIToolbox</i></b> performs hypothesis testing for comparisons on two types of data: scalar (i.e.
        single values) and correlation matrices. The idea behind the statistical testing is to assess differences
        between experimental groups with an exploratory approach. This means that we have chosen tests, in particular
        postHoc multiple comparisons, that are less strict when rejecting the null hypothesis. Thus, this approach has
        the advantage of increasing the probability of detection of significant differences between experimental groups.
        On the other hand, this may also increase the probability of false positives (i.e. type I error). Given that, if
        your project has other needs in terms of statistical analysis, it is advisable to perform the necessary
        statistical comparisons outside the toolbox.
    </p>
    <h3>Available tests</h3>
    <hr>
    <p>
        Our toolbox performs statistical comparisons using the available with Matlab's <i>Statistics and Machine
            Learning Toolbox</i>. The functions used are the following (click on links for details):
    </p>
    <table style="table-layout: fixed;">
        <tr>
            <th style="width:230px" align="left">Function</th>
            <th align="left"> usage</th>
        </tr>
        <tr>
            <td class="add_font_monospace"><a href="https://www.mathworks.com/help/stats/ttest.html">ttest</a></td>
            <td>Paired two-sampled T-test</td>
        </tr>
        <tr>
            <td class="add_font_monospace"><a href="https://www.mathworks.com/help/stats/signrank.html">signrank</a>
            </td>
            <td>Non-parametric Wilcoxon signed rank test for paired two-sampled data</td>
        </tr>
        <tr>
            <td class="add_font_monospace"><a href="https://www.mathworks.com/help/stats/ttest2.html">ttest2</a></td>
            <td> T-test for independent two-sampled data</td>
        </tr>
        <tr>
            <td class="add_font_monospace"><a href="https://www.mathworks.com/help/stats/anova1.html">anova1</a></td>
            <td>One-way analysis of variance</td>
        </tr>
        <tr>
            <td class="add_font_monospace"><a
                    href="https://www.mathworks.com/help/stats/kruskalwallis.html">kruskalwallis</a></td>
            <td>Kruskal-Wallis Test. Non-parametric version of the classical One-way ANOVA</td>
        </tr>
        <tr>
            <td class="add_font_monospace"><a href="https://www.mathworks.com/help/stats/anovan.html">anovan</a></td>
            <td>N-way analysis of variance. This function is used to perform Two-Way ANOVA.</td>
        </tr>
        <tr>
            <td class="add_font_monospace"><a
                    href="https://www.mathworks.com/help/stats/repeatedmeasuresmodel.ranova.html">ranova</a></td>
            <td>Repeated measures (rm) analysis of variance. Used to analyse One and Two-way rmANOVA</td>
        </tr>
    </table>
    <h4>ANOVA's postHoc tests</h4>
    <div class="infonote">
        <p><strong>A note on ANOVA's postHoc tests</strong><br>
            Multiple comparisons after ANOVA are performed using Matlab's <a
                href="https://www.mathworks.com/help/stats/multcompare.html">multcompare</a> function. Different methods
            are using depending on the data type. For <b>scalar</b> data, we use the <a
                href="https://www.mathworks.com/help/stats/multiple-comparisons.html"><i>Dunn & Sid√°k</i></a>'s approach
            while for <b>correlation matrices</b>, we use the <a
                href="https://www.mathworks.com/help/stats/multiple-comparisons.html">Fisher's least significant
                difference procedure</a>.
        </p>
    </div>
    <h3>Validation of normality and homogeneity of variances</h3>
    <hr>
    <p>
        Before the execution of statistical tests, we test if the data follows a normal distribution and, for Two-Way
        ANOVA and Repeated Measures, we also check if the variances are roughly equal.
    </p>
    <h4>Normality check</h4>
    <p>
        For each group of data, the normality is tested using the Lilliefors test statistic (click <a
            href="https://www.mathworks.com/help/stats/lillietest.html">here</a> for details). If <i>all</i>groups of
        data are normally distributed, the algorithm will use the <b>parametric</b> tests. In contrast, if one or more
        groups are not normally distributed, <b>non-parametric</b> versions will be used instead.
    </p>
    <div class="warnnote">
        <p><strong>Important</strong><br>
            Non-parametric versions of <b>Two-Way ANOVA</b> and <b>Repeated Measures ANOVA</b> tests are currently
            unavailable. Therefore, if the data is not normally distributed, no statistical test will be performed.
        </p>
    </div>
    <h4>Homogeneity check</h4>
    <p>
        This parameter applies to <b>ANOVA</b> only. Given that homoscedascity (i.e. homogeneity of variances) is one of
        the assumptions considered for ANOVA tests, we test for this as well. However, in our case, we use a very
        "loose" criterium where we consider <b> heterogeneous variances</b> only if the ratio of the largest to the
        smallest variance exceeds <b>4:1</b> (from S. McKillup, 2011).
    </p>
    <div class="infonote">
        <p><strong>Note</strong><br>
            Differently from the test for normal distribution, if the data fails the test for homogeneous variances, a
            warning message will be issued and the <b>ANOVA</b> tests will be executed. Just, be mindful that if this
            assumption was violated, caution must be taken when interpreting the results!
        </p>
    </div>
    <h3>The stats report</h3>
    <hr>
    <p>
        The results of the statistical comparisons are summarized in text format. Here is an example:
    </p>
    <div class="black-box">
        <pre style="white-space: pre;">
-----------------------Statistical Hypothesis test report-----------------------
Run date: 31-Jan-2023 15:19:21

The data was grouped by 4 Acquisition(s) vs 1 Group(s) and split by a total of 2 ROI(s).

The hypothesis test executed was "OneWayRepeatedMeasures"
--------------------------------------------------------------------------------
Subgroup name: V1_L
Comparison performed: "Group by Acquisition"
Stats:
                        | SumSq        | DF | MeanSq       | F    | pValue   | pValueGG | pValueHF | pValueLB
----------------------------------------------------------------------------------------------------------------
(Intercept):Acquisition | 3834557.0772 | 3  | 1278185.6924 | 5.34 | 0.039453 | 0.11679  | 0.041287 | 0.14705 
Error(Acquisition)      | 1436169.8271 | 6  | 239361.6379  | 1    | 0.5      | 0.5      | 0.5      | 0.5     
----------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------
Subgroup name: M1_L
Comparison performed: "Group by Acquisition"
Stats:
                        | SumSq        | DF | MeanSq       | F       | pValue   | pValueGG | pValueHF | pValueLB
-------------------------------------------------------------------------------------------------------------------
(Intercept):Acquisition | 8037592.474  | 3  | 2679197.4913 | 13.8299 | 0.001019 | 0.024357 | 0.013864 | 0.033834
Error(Acquisition)      | 1743525.0665 | 9  | 193725.0074  | 1       | 0.5      | 0.5      | 0.5      | 0.5     
-------------------------------------------------------------------------------------------------------------------
Post hoc tests:
Test name: "dunn-sidak"
Group | Acquisition_1 | Acquisition_2 | Difference | StdErr   | pValue    | Lower      | Upper     
------------------------------------------------------------------------------------------------------
Test  | 1             | 2             | -1440.2109 | 323.7878 | 0.12032   | -3442.7823 | 562.3605  
Test  | 1             | 3             | -1628.5807 | 238.8235 | 0.038088  | -3105.6625 | -151.4988 
Test  | 1             | 4             | -1773.1094 | 83.0401  | 0.0013478 | -2286.6982 | -1259.5207
Test  | 2             | 1             | 1440.2109  | 323.7878 | 0.12032   | -562.3605  | 3442.7823 
Test  | 2             | 3             | -188.3698  | 504.0576 | 0.99964   | -3305.8782 | 2929.1386 
Test  | 2             | 4             | -332.8986  | 355.4188 | 0.96115   | -2531.102  | 1865.3049 
Test  | 3             | 1             | 1628.5807  | 238.8235 | 0.038088  | 151.4988   | 3105.6625 
Test  | 3             | 2             | 188.3698   | 504.0576 | 0.99964   | -2929.1386 | 3305.8782 
Test  | 3             | 4             | -144.5287  | 178.9066 | 0.97984   | -1251.0349 | 961.9774  
Test  | 4             | 1             | 1773.1094  | 83.0401  | 0.0013478 | 1259.5207  | 2286.6982 
Test  | 4             | 2             | 332.8986   | 355.4188 | 0.96115   | -1865.3049 | 2531.102  
Test  | 4             | 3             | 144.5287   | 178.9066 | 0.97984   | -961.9774  | 1251.0349 
------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------
    </pre>
    </div>
    <p>
        The report consists of a first section containing basic information about the data and the type of statistical
        comparison (e.g. <samp>OneWayRepeatedMeasures</samp>). The other sections are separated by <b>subgroups</b>. In
        the example above, the data of each "ROI" was analysed separately. The content of each section varies depending
        on the test applied. In the example above, the ANOVA table is shown under the "Stats:" section for the first
        subgroup. As for the second one, the results of the post hoc test are shown given that "significant" differences
        were detected in the ANOVA test.
    </p>
    <h3>Statistical comparisons of correlation matrices: a special case</h3>
    <hr>
    <p>
        

    </p>

    <h3>References</h3>
    <hr>
    <ol>
        <li>
            McKillup, Steve. ‚ÄúStatistics Explained: An Introductory Guide for Life Scientists.‚Äù Higher Education from
            Cambridge University Press. Cambridge University Press, November 2, 2011. <a
                href="https://doi.org/10.1017/CBO9781139047500">https://doi.org/10.1017/CBO9781139047500</a>.
        </li>
    </ol>
</body>

</html>