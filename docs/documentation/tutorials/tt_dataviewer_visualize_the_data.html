<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <link rel="stylesheet" href="../../css/master.css">
    <meta charset="utf-8">
    <title>Visualize imaging data</title>
  </head>
  <body>
    <h2>Visualize imaging data</h2>
    <hr>
    <p>
      In this tutorial you will learn the basics of the <i>DataViewer</i> app to visualize and explore different types of imaging data. The <i>DataViewer</i> app open the following types of imaging data:
      <ul>
        <li><i>Images</i>: 2D arrays with dimensions Y,X.</li>
        <li><i>Image time series</i>: 3D arrays with dimensions Y,X,T(ime).</li>
        <li><i>Event-triggered image time series</i>: 4D arrays with dimensions Y,X,T,E(vent).</li>
        <li><i>Correlation Maps</i>: 3D arrays with dimensions Y,X,S(eed).</li>
      </ul>
      Here, we will explore some of the data created in the previous tutorials on how to <i>Preprocess imaging data</i>. This tutorial focuses on the basic use of the <i>DataViewer</i> app to explore individual imaging dataset. To learn about all the functionalities of the app, read it's full documentation <a href="../userDocs/DataViewer.html">here</a>.
    </p>
    <h3>Sections</h3>
    <hr>
    <ul>
      <li><a href="#open-data">Open imaging data</a>: open imaging data in <i>DataViewer</i> through the main GUI or as a standalone.</li>
      <li><a href="#viz-image-time-series">Basic data exploration</a>: explore an image time series data to learn the basics of <i>DataViewer</i>.</li>
      <li><a href="#viz-spcm">Visualize functional maps</a>: explore a Seed-pixel correlation map.</li>
      <li><a href="#viz-event-triggered-data">Visualize event-triggered data</a>: explore event-triggered image time series.</li>
    </ul>
    <h3 id="open-data">Open imaging data</h3>
    <hr>
    <p>
      You can launch <i>DataViewer</i> from the main GUI or as a standalone from Matlab's command window.
    </p>
    <h4>Launch <i>DataViewer</i> from the main GUI</h4>
    <p>
      In Matlab's command window, launch the main GUI:
    </p>
    <div class="codeinput">
      <pre>
        umIToolbox(<font class="stringformat">'C:/FOLDER/projectfile.mat'</font>);
      </pre>
    </div>
    <p>
      Go to the <i>Visualization</i> tab. Then select the object containing the file to be opened (step 1). In the <i>Select a file:</i> list box, select the file (step 2) - in this example, <samp>HP_tempFilt.dat</samp>. Finally, click on the app's button (step 3) to launch <i>DataViewer</i>:
    </p>
    <img src="../assets/img/tt_dataviewer_open_data_from_mainGUI.png" alt="tt_dataviewer_open_data_from_mainGUI" width="660">
    <h4>Launch <i>DataViewer</i> as standalone</h4>
    <p>
      To open an imaging file in <i>DataViewer</i> directly from Matlab's command window,launch <i>DataViewer</i> with the full path of the file as input:
    </p>
    <div class="codeinput">
      <pre>
        DataViewer(<font class="stringformat">'C:/FOLDER/PROJECT_SAVEFOLDER/HP_tempFilt.dat'</font>);
      </pre>
    </div>
    <p>
      Alternatively, launch the <i>DataViewer</i> app:
    </p>
    <div class="codeinput">
      <pre>
        DataViewer
      </pre>
    </div>
    <p>
      In <i>DataViewer</i>'s main window, go to <i>File &gt;&gt; Open</i> and select the <samp>.dat</samp> file to open:
    </p>
    <img src="../assets/img/tt_dataviewer_open_data_from_standalone.png" alt="tt_dataviewer_open_data_from_standalone" width = "660">
    <h3 id="viz-image-time-series">Basic data exploration</h3>
    <hr>
    <p>
      In this tutorial, we will explore an intermediate step from the preproceesing of a resting state experiment. The data stored in the file <samp>HP_tempFilt.dat</samp> consists of the fluorescence signal that was corrected for the hemodynamic artifacts, followed by the removal of the global signal variance and temporally filtered and normalized (check the tutorial on <a href="tt_creating_connectivity_maps.html">preprocessing data for resting state</a> for details).
    </p>
    <p>
      Below is a screenshot of the app with the data loaded. It consists of three windows: the main window (1), where all the options and controls are located, the image window (2) where the current frame of the data is shown, and the temporal signal window (3) where the temporal profile of the selected pixel is displayed.
    </p>
    <img src="../assets/img/tt_dataviewer_app_overview.png" alt="tt_dataviewer_app_overview" width="880">
    <p>
      Click on a pixel to get it's temporal profile:
    </p>
    <video src="../assets/gifs/tt_dataviewer_select_px.mp4" alt="tt_dataviewer_select_px" width = "880" controls></video>
    <p>
      To change frames, either <b>move the slider</b> in the main window or <b>double-click</b> on the plot from the temporal signal window:
    </p>
    <video src="../assets/gifs/tt_dataviewer_select_frame.mp4" alt="tt_dataviewer_select_frame" width = "880" controls></video>
    <p>
      Also, use the figure's <i>datatip</i> tool <img src="../assets/img/tt_dataviewer_datatip_icon.png" alt="tt_dataviewer_datatip_icon"> to add fixed data tips over the image or the temporal profile to show the pixel values as so:
    </p>
    <img src="../assets/img/tt_dataviewer_datatips_example.png" alt="tt_dataviewer_datatips_example" width = "880">
    <div class="warnnote">
      <p><strong>Important</strong><br>
        Don't forget to <b>deactivate</b> the datatip button before interacting with the figure. Some of the figure's interactions are suspended when the datatip mode is active.
      </p>
    </div>
    <p>
      Now, let's adjust the color scale limits to better visualize the fluctuations of the fluorescence signal across the mouse cortex. To do so you can simply use the vertical zoom option on the temporal signal window as so:
    </p>
    <video src="../assets/gifs/tt_dataviewer_set_clims_by_zoom.mp4" alt="tt_dataviewer_set_clims_by_zoom" width = "880" controls></video>
    <p>
      If you want to give a precise number, go to <i>Settings &gt;&gt; Image Options</i> and change the values of <b>min</b> and <b>max</b>. In addition, we can also change the default colormap through the <i>Image Options</i>:
    </p>
    <video src="../assets/gifs/tt_dataviewer_set_clims_and_colormap_in_imagOpts.mp4" alt="tt_dataviewer_set_clims_and_colormap_in_imagOpts" width = "880" controls></video>
    <p>
      Finally, we can use the playback button to display the "movie" of the fluorescence signal. This recording was obtained with a frame rate of 5Hz (default playback speed). We can change the playback speed in <i>Settings &gt;&gt; Playback speed</i>. Below, we can observe the fluctuations of the fluorescence signal across the mouse cortical areas (playback speed at 3 times the real frame rate):
    </p>
    <video src="../assets/gifs/tt_dataviewer_playback.mp4" alt="tt_dataviewer_playback" width = "880" controls></video>
    <h3 id="viz-spcm">Visualize functional maps</h3>
    <hr>
    <p>
      The functional connectivity maps created in <a href="tt_creating_connectivity_maps.html">this tutorial</a> were stored in the file <samp>SCPMap.dat</samp>. This data consists of a 3D array containing correlation values where each frame represents the correlation map for a given seed pixel.
    </p>
    <p>
      When visualizing a correlation map, the behaviour of the image's crosshair is different from the other imaging data types. Here, when clicking on a pixel, the correlation map is updated to show the map from the selected pixel as the seed:
    </p>
    <video src="../assets/gifs/tt_dataviewer_spcm_overview.mp4" alt="tt_dataviewer_spcm_overview" width = "660" controls></video>

    <h3 id="viz-event-triggered-data">Visualize event-triggered data</h3>
    <hr>
    <p>
      For images and image time series split by events, the <i>DataViewer</i> app shows an extra window, the Events window, containing the conditions and event repetitions. You can select one repetition or the average (<samp><font class="stringformat">#Average</font></samp>). The example below was drawn from the tutorial on <a href="./tt_creating_event_triggered_avg_maps.html">preproceesing event-triggered data</a>  and it represents the normalized fluorescence signal of a whiskers stimulation split in 10 trials.
    </p>
    <video src="../assets/gifs/tt_dataviewer_example_data_split_by_evnt.mp4" alt="tt_dataviewer_example_data_split_by_evnt" width ="880" controls></video>
  </body>
</html>
